__device__ double basis_eval(double x, double y, int i) {
    switch (i) {
        case 0: return   1.414213562373095E+00;
        case 1: return  -1.999999999999999E+00+ 5.999999999999999E+00*x;
        case 2: return  -3.464101615137754E+00+ 3.464101615137750E+00*x+ 6.928203230275512E+00*y;
        case 3: return   2.449489742783153E+00+-1.959591794226528E+01*x+ 1.648597081617952E-14*y+ 2.449489742783160E+01*x*x;
        case 4: return   4.242640687119131E+00+-2.545584412271482E+01*x+-8.485281374238392E+00*y+ 2.121320343559552E+01*x*x+ 4.242640687119219E+01*x*y;
        case 5: return   5.477225575051629E+00+-1.095445115010309E+01*x+-3.286335345030997E+01*y+ 5.477225575051381E+00*x*x+ 3.286335345031001E+01*x*y+ 3.286335345030994E+01*y*y;
        case 6: return  -2.828427124742674E+00+ 4.242640687116461E+01*x+-7.573552134493922E-12*y+-1.272792206135164E+02*x*x+ 1.480773761026334E-11*x*y+ 5.598437621001612E-12*y*y+ 9.899494936607567E+01*x*x*x;
        case 7: return  -4.898979485552100E+00+ 6.368673331219978E+01*x+ 9.797958971110390E+00*y+-1.616663230232790E+02*x*x+-1.175755076534249E+02*x*y+ 6.193426205505117E-12*y*y+ 1.028785691966154E+02*x*x*x+ 2.057571383935418E+02*x*x*y;
        case 8: return  -6.324555320324137E+00+ 5.692099788284931E+01*x+ 3.794733192202038E+01*y+-9.486832980456133E+01*x*x+-3.035786553760383E+02*x*y+-3.794733192204275E+01*y*y+ 4.427188724202135E+01*x*x*x+ 2.656313234538372E+02*x*x*y+ 2.656313234542428E+02*x*y*y;
        case 9: return  -7.483314773585763E+00+ 2.244994432091432E+01*x+ 8.979977728286150E+01*y+-2.244994432106859E+01*x*x+-1.795995545666577E+02*x*y+-2.244994432069088E+02*y*y+ 7.483314773734342E+00*x*x*x+ 8.979977728384534E+01*x*x*y+ 2.244994432077823E+02*x*y*y+ 1.496662954711719E+02*y*y*y;
        case 10: return  3.162277659932381E+00+-7.589466384207020E+01*x+ 1.426176469642703E-09*y+ 3.984469851776336E+02*x*x+-7.910579797240936E-09*x*y+-2.221386508489322E-09*y*y+-7.083501958763851E+02*x*x*x+ 7.621485651163695E-09*x*x*y+ 6.067021191238202E-09*x*y*y+ 1.028693334372986E-09*y*y*y+ 3.984469851817817E+02*x*x*x*x;
        case 11: return  5.477225573293454E+00+-1.204989626165627E+02*x+-1.095445114633290E+01*y+ 5.751086852221304E+02*x*x+ 2.300434740977508E+02*x*y+-2.068407262794661E-09*y*y+-9.201738963566557E+02*x*x*x+-9.201738964277876E+02*x*x*y+ 8.157350468216520E-09*x*y*y+ 6.689323593113725E-10*y*y*y+ 4.600869481761621E+02*x*x*x*x+ 9.201738964414616E+02*x*x*x*y;
        case 12: return  7.071067805455000E+00+-1.272792204805459E+02*x+-4.242640685227210E+01*y+ 4.879036784195053E+02*x*x+ 7.212489164466416E+02*x*y+ 4.242640686115994E+01*y*y+-6.222539665248095E+02*x*x*x+-2.206173156074114E+03*x*x*y+-6.788225097240384E+02*x*y*y+-2.618257708956216E-09*y*y*y+ 2.545584407762581E+02*x*x*x*x+ 1.527350646359356E+03*x*x*x*y+ 1.527350646878523E+03*x*x*y*y;
        case 13: return  8.366600260526104E+00+-1.003992030768338E+02*x+-1.003992031718044E+02*y+ 2.509980074706584E+02*x*x+ 1.104391234720425E+03*x*y+ 2.509980079602665E+02*y*y+-2.342648066787563E+02*x*x*x+-1.907584859424864E+03*x*x*y+-2.509980079423497E+03*x*y*y+-1.673320053154932E+02*y*y*y+ 7.529940202066899E+01*x*x*x*x+ 9.035928277891566E+02*x*x*x*y+ 2.258982071161214E+03*x*x*y*y+ 1.505988047779402E+03*x*y*y*y;
        case 14: return  9.486832983521653E+00+-3.794733194390820E+01*x+-1.897366596555042E+02*y+ 5.692099790539108E+01*x*x+ 5.692099791671884E+02*x*y+ 8.538149683896320E+02*y*y+-3.794733189560607E+01*x*x*x+-5.692099793702737E+02*x*x*y+-1.707629937257380E+03*x*y*y+-1.328156617433492E+03*y*y*y+ 9.486832949529969E+00*x*x*x*x+ 1.897366598407721E+02*x*x*x*y+ 8.538149689079755E+02*x*x*y*y+ 1.328156617726260E+03*x*y*y*y+ 6.640783086958844E+02*y*y*y*y;
        case 15: return -3.464101558949990E+00+ 1.212435559200072E+02*x+-6.554927287342971E-07*y+-9.699484511343436E+02*x*x+ 6.168075543844670E-06*x*y+ 1.855928121585948E-06*y*y+ 2.909845358057180E+03*x*x*x+-1.315541065068287E-05*x*x*y+-1.130274504940533E-05*x*y*y+-2.010826993623497E-06*y*y*y+-3.637306700193426E+03*x*x*x*x+ 7.812696673194998E-06*x*x*x*y+ 1.182910267641302E-05*x*x*y*y+ 5.966502721149417E-06*x*y*y*y+ 7.490370807424855E-07*y*y*y*y+ 1.600414948629347E+03*x*x*x*x*x;
        case 16: return -5.999999786381989E+00+ 1.979999956525627E+02*x+ 1.199999852846904E+01*y+-1.487999975474801E+03*x*x+-3.839999824158518E+02*x*y+ 3.590733134991923E-06*y*y+ 4.175999942031873E+03*x*x*x+ 2.591999942138422E+03*x*x*y+-2.304845967213866E-05*x*y*y+-3.765206360347302E-06*y*y*y+-4.859999939177293E+03*x*x*x*x+-5.759999920481709E+03*x*x*x*y+ 2.533800791146071E-05*x*x*y*y+ 1.163201295009333E-05*x*y*y*y+ 1.375929645239261E-06*y*y*y*y+ 1.979999976733127E+03*x*x*x*x*x+ 3.959999958598952E+03*x*x*x*x*y;
        case 17: return -7.745965695420901E+00+ 2.246330064931837E+02*x+ 4.647579541948504E+01*y+-1.471733486303566E+03*x*x+-1.301322301662001E+03*x*y+-4.647579318622461E+01*y*y+ 3.578636133115430E+03*x*x*x+ 7.529079078085794E+03*x*x*y+ 1.254846513301883E+03*x*y*y+-4.908706745821598E-06*y*y*y+-3.601873989014308E+03*x*x*x*x+-1.394273903583612E+04*x*x*x*y+-6.274232689483983E+03*x*x*y*y+ 1.557818297216641E-05*x*y*y*y+ 1.774768472967930E-06*y*y*y*y+ 1.278084301040559E+03*x*x*x*x*x+ 7.668506441990577E+03*x*x*x*x*y+ 7.668506664656632E+03*x*x*x*y*y;
        case 18: return -9.165149435198423E+00+ 2.107984283759371E+02*x+ 1.099818044339292E+02*y+-1.081487516924421E+03*x*x+-2.419599681468854E+03*x*y+-2.749545200140819E+02*y*y+ 2.071323351561491E+03*x*x*x+ 1.055825295075658E+04*x*x*y+ 5.774044953825824E+03*x*y*y+ 1.833030149275268E+02*y*y*y+-1.695552095854663E+03*x*x*x*x+-1.429763371616711E+04*x*x*x*y+-2.062158902373028E+04*x*x*y*y+-3.666060369213731E+03*x*y*y*y+ 1.477433029163776E-06*y*y*y*y+ 5.040829816128482E+02*x*x*x*x*x+ 6.048998614115979E+03*x*x*x*x*y+ 1.512249834952116E+04*x*x*x*y*y+ 1.008166605651047E+04*x*x*y*y*y;
        case 19: return -1.039230291051524E+01+ 1.558845242254402E+02*x+ 2.078460790604852E+02*y+-5.196149513118795E+02*x*x+-2.909844994480356E+03*x*y+-9.353073863098218E+02*y*y+ 7.274606525680852E+02*x*x*x+ 7.482457909279853E+03*x*x*y+ 1.215899583458535E+04*x*y*y+ 1.454922624147049E+03*y*y*y+-4.676530172095034E+02*x*x*x*x+-7.066764912559228E+03*x*x*x*y+-2.151206857134464E+04*x*x*y*y+-1.745907139924879E+04*x*y*y*y+-7.274613189125139E+02*y*y*y*y+ 1.143150941224163E+02*x*x*x*x*x+ 2.286305899408025E+03*x*x*x*x*y+ 1.028837996460899E+04*x*x*x*y*y+ 1.600414831467970E+04*x*x*y*y*y+ 8.002074513731438E+03*x*y*y*y*y;
        case 20: return -1.148912453686957E+01+ 5.744560862969394E+01*x+ 3.446737503461372E+02*y+-1.148911495763160E+02*x*x+-1.378694882483679E+03*x*y+-2.412716282265750E+03*y*y+ 1.148910142070014E+02*x*x*x+ 2.068041931439891E+03*x*x*y+ 7.238148529865374E+03*x*y*y+ 6.433910121171304E+03*y*y*y+-5.744538632836686E+01*x*x*x*x+-1.378694134049671E+03*x*x*x*y+-7.238147869806153E+03*x*x*y*y+-1.286781990429334E+04*x*y*y*y+-7.238148907286980E+03*y*y*y*y+ 1.148903744345461E+01*x*x*x*x*x+ 3.446733285357364E+02*x*x*x*x*y+ 2.412715565158995E+03*x*x*x*y*y+ 6.433909612999752E+03*x*x*y*y*y+ 7.238148781371233E+03*x*y*y*y*y+ 2.895259567891218E+03*y*y*y*y*y;
    }
}

__device__ double basis_eval_x(double x, double y, int i) {
    switch (i) {
        case 0: return   0;
        case 1: return  5.999999999999999E+00;
        case 2: return   3.464101615137750E+00;
        case 3: return  -1.959591794226528E+01+ 2*2.449489742783160E+01*x;
        case 4: return  -2.545584412271482E+01+ 2*2.121320343559552E+01*x+ 4.242640687119219E+01*y;
        case 5: return  -1.095445115010309E+01+ 2*5.477225575051381E+00*x+ 3.286335345031001E+01*y;
        case 6: return   4.242640687116461E+01+-2*1.272792206135164E+02*x+ 1.480773761026334E-11*y+ 3*9.899494936607567E+01*x*x;
        case 7: return   6.368673331219978E+01+-2*1.616663230232790E+02*x+-1.175755076534249E+02*y+ 3*1.028785691966154E+02*x*x+ 2*2.057571383935418E+02*x*y;
        case 8: return   5.692099788284931E+01+-2*9.486832980456133E+01*x+-3.035786553760383E+02*y+ 3*4.427188724202135E+01*x*x+ 2*2.656313234538372E+02*x*y+ 2.656313234542428E+02*y*y;
        case 9: return   2.244994432091432E+01+-2*2.244994432106859E+01*x+-1.795995545666577E+02*y+ 3*7.483314773734342E+00*x*x+ 2*8.979977728384534E+01*x*y+ 2.244994432077823E+02*y*y;
        case 10: return -7.589466384207020E+01+ 2*3.984469851776336E+02*x+-7.910579797240936E-09*y+-3*7.083501958763851E+02*x*x+ 2*7.621485651163695E-09*x*y+ 6.067021191238202E-09*y*y+ 4*3.984469851817817E+02*x*x*x;
        case 11: return -1.204989626165627E+02+ 2*5.751086852221304E+02*x+ 2.300434740977508E+02*y+-3*9.201738963566557E+02*x*x+-2*9.201738964277876E+02*x*y+ 8.157350468216520E-09*y*y+ 4*4.600869481761621E+02*x*x*x+ 3*9.201738964414616E+02*x*x*y;
        case 12: return -1.272792204805459E+02+ 2*4.879036784195053E+02*x+ 7.212489164466416E+02*y+-3*6.222539665248095E+02*x*x+-2*2.206173156074114E+03*x*y+-6.788225097240384E+02*y*y+ 4*2.545584407762581E+02*x*x*x+ 3*1.527350646359356E+03*x*x*y+ 2*1.527350646878523E+03*x*y*y;
        case 13: return -1.003992030768338E+02+ 2*2.509980074706584E+02*x+ 1.104391234720425E+03*y+-3*2.342648066787563E+02*x*x+-2*1.907584859424864E+03*x*y+-2.509980079423497E+03*y*y+ 4*7.529940202066899E+01*x*x*x+ 3*9.035928277891566E+02*x*x*y+ 2*2.258982071161214E+03*x*y*y+ 1.505988047779402E+03*y*y*y;
        case 14: return -3.794733194390820E+01+ 2*5.692099790539108E+01*x+ 5.692099791671884E+02*y+-3*3.794733189560607E+01*x*x+-2*5.692099793702737E+02*x*y+-1.707629937257380E+03*y*y+ 4*9.486832949529969E+00*x*x*x+ 3*1.897366598407721E+02*x*x*y+ 2*8.538149689079755E+02*x*y*y+ 1.328156617726260E+03*y*y*y;
        case 15: return  1.212435559200072E+02+-2*9.699484511343436E+02*x+ 6.168075543844670E-06*y+ 3*2.909845358057180E+03*x*x+-2*1.315541065068287E-05*x*y+-1.130274504940533E-05*y*y+-4*3.637306700193426E+03*x*x*x+ 3*7.812696673194998E-06*x*x*y+ 2*1.182910267641302E-05*x*y*y+ 5.966502721149417E-06*y*y*y+ 5*1.600414948629347E+03*x*x*x*x;
        case 16: return  1.979999956525627E+02+-2*1.487999975474801E+03*x+-3.839999824158518E+02*y+ 3*4.175999942031873E+03*x*x+ 2*2.591999942138422E+03*x*y+-2.304845967213866E-05*y*y+-4*4.859999939177293E+03*x*x*x+-3*5.759999920481709E+03*x*x*y+ 2*2.533800791146071E-05*x*y*y+ 1.163201295009333E-05*y*y*y+ 5*1.979999976733127E+03*x*x*x*x+ 4*3.959999958598952E+03*x*x*x*y;
        case 17: return  2.246330064931837E+02+-2*1.471733486303566E+03*x+-1.301322301662001E+03*y+ 3*3.578636133115430E+03*x*x+ 2*7.529079078085794E+03*x*y+ 1.254846513301883E+03*y*y+-4*3.601873989014308E+03*x*x*x+-3*1.394273903583612E+04*x*x*y+-2*6.274232689483983E+03*x*y*y+ 1.557818297216641E-05*y*y*y+ 5*1.278084301040559E+03*x*x*x*x+ 4*7.668506441990577E+03*x*x*x*y+ 3*7.668506664656632E+03*x*x*y*y;
        case 18: return  2.107984283759371E+02+-2*1.081487516924421E+03*x+-2.419599681468854E+03*y+ 3*2.071323351561491E+03*x*x+ 2*1.055825295075658E+04*x*y+ 5.774044953825824E+03*y*y+-4*1.695552095854663E+03*x*x*x+-3*1.429763371616711E+04*x*x*y+-2*2.062158902373028E+04*x*y*y+-3.666060369213731E+03*y*y*y+ 5*5.040829816128482E+02*x*x*x*x+ 4*6.048998614115979E+03*x*x*x*y+ 3*1.512249834952116E+04*x*x*y*y+ 2*1.008166605651047E+04*x*y*y*y;
        case 19: return  1.558845242254402E+02+-2*5.196149513118795E+02*x+-2.909844994480356E+03*y+ 3*7.274606525680852E+02*x*x+ 2*7.482457909279853E+03*x*y+ 1.215899583458535E+04*y*y+-4*4.676530172095034E+02*x*x*x+-3*7.066764912559228E+03*x*x*y+-2*2.151206857134464E+04*x*y*y+-1.745907139924879E+04*y*y*y+ 5*1.143150941224163E+02*x*x*x*x+ 4*2.286305899408025E+03*x*x*x*y+ 3*1.028837996460899E+04*x*x*y*y+ 2*1.600414831467970E+04*x*y*y*y+ 8.002074513731438E+03*y*y*y*y;
        case 20: return  5.744560862969394E+01+-2*1.148911495763160E+02*x+-1.378694882483679E+03*y+ 3*1.148910142070014E+02*x*x+ 2*2.068041931439891E+03*x*y+ 7.238148529865374E+03*y*y+-4*5.744538632836686E+01*x*x*x+-3*1.378694134049671E+03*x*x*y+-2*7.238147869806153E+03*x*y*y+-1.286781990429334E+04*y*y*y+ 5*1.148903744345461E+01*x*x*x*x+ 4*3.446733285357364E+02*x*x*x*y+ 3*2.412715565158995E+03*x*x*y*y+ 2*6.433909612999752E+03*x*y*y*y+ 7.238148781371233E+03*y*y*y*y;
    }
}
__device__ double basis_eval_y(double x, double y, int i) {
    switch (i) {
        case 0: return   0;
        case 1: return   0;
        case 2: return   6.928203230275512E+00;
        case 3: return   1.648597081617952E-14;
        case 4: return  -8.485281374238392E+00+ 4.242640687119219E+01*x;
        case 5: return  -3.286335345030997E+01+ 3.286335345031001E+01*x+ 2*3.286335345030994E+01*y;
        case 6: return  -7.573552134493922E-12+ 1.480773761026334E-11*x+ 2*5.598437621001612E-12*y;
        case 7: return   9.797958971110390E+00+-1.175755076534249E+02*x+ 2*6.193426205505117E-12*y+ 2.057571383935418E+02*x*x;
        case 8: return   3.794733192202038E+01+-3.035786553760383E+02*x+-2*3.794733192204275E+01*y+ 2.656313234538372E+02*x*x+ 2*2.656313234542428E+02*x*y;
        case 9: return   8.979977728286150E+01+-1.795995545666577E+02*x+-2*2.244994432069088E+02*y+ 8.979977728384534E+01*x*x+ 2*2.244994432077823E+02*x*y+ 3*1.496662954711719E+02*y*y;
        case 10: return  1.426176469642703E-09+-7.910579797240936E-09*x+-2*2.221386508489322E-09*y+ 7.621485651163695E-09*x*x+ 2*6.067021191238202E-09*x*y+ 3*1.028693334372986E-09*y*y;
        case 11: return -1.095445114633290E+01+ 2.300434740977508E+02*x+-2*2.068407262794661E-09*y+-9.201738964277876E+02*x*x+ 2*8.157350468216520E-09*x*y+ 3*6.689323593113725E-10*y*y+ 9.201738964414616E+02*x*x*x;
        case 12: return -4.242640685227210E+01+ 7.212489164466416E+02*x+ 2*4.242640686115994E+01*y+-2.206173156074114E+03*x*x+-2*6.788225097240384E+02*x*y+-3*2.618257708956216E-09*y*y+ 1.527350646359356E+03*x*x*x+ 2*1.527350646878523E+03*x*x*y;
        case 13: return -1.003992031718044E+02+ 1.104391234720425E+03*x+ 2*2.509980079602665E+02*y+-1.907584859424864E+03*x*x+-2*2.509980079423497E+03*x*y+-3*1.673320053154932E+02*y*y+ 9.035928277891566E+02*x*x*x+ 2*2.258982071161214E+03*x*x*y+ 3*1.505988047779402E+03*x*y*y;
        case 14: return -1.897366596555042E+02+ 5.692099791671884E+02*x+ 2*8.538149683896320E+02*y+-5.692099793702737E+02*x*x+-2*1.707629937257380E+03*x*y+-3*1.328156617433492E+03*y*y+ 1.897366598407721E+02*x*x*x+ 2*8.538149689079755E+02*x*x*y+ 3*1.328156617726260E+03*x*y*y+ 4*6.640783086958844E+02*y*y*y;
        case 15: return -6.554927287342971E-07+ 6.168075543844670E-06*x+ 2*1.855928121585948E-06*y+-1.315541065068287E-05*x*x+-2*1.130274504940533E-05*x*y+-3*2.010826993623497E-06*y*y+ 7.812696673194998E-06*x*x*x+ 2*1.182910267641302E-05*x*x*y+ 3*5.966502721149417E-06*x*y*y+ 4*7.490370807424855E-07*y*y*y;
        case 16: return  1.199999852846904E+01+-3.839999824158518E+02*x+ 2*3.590733134991923E-06*y+ 2.591999942138422E+03*x*x+-2*2.304845967213866E-05*x*y+-3*3.765206360347302E-06*y*y+-5.759999920481709E+03*x*x*x+ 2*2.533800791146071E-05*x*x*y+ 3*1.163201295009333E-05*x*y*y+ 4*1.375929645239261E-06*y*y*y+ 3.959999958598952E+03*x*x*x*x;
        case 17: return  4.647579541948504E+01+-1.301322301662001E+03*x+-2*4.647579318622461E+01*y+ 7.529079078085794E+03*x*x+ 2*1.254846513301883E+03*x*y+-3*4.908706745821598E-06*y*y+-1.394273903583612E+04*x*x*x+-2*6.274232689483983E+03*x*x*y+ 3*1.557818297216641E-05*x*y*y+ 4*1.774768472967930E-06*y*y*y+ 7.668506441990577E+03*x*x*x*x+ 2*7.668506664656632E+03*x*x*x*y;
        case 18: return  1.099818044339292E+02+-2.419599681468854E+03*x+-2*2.749545200140819E+02*y+ 1.055825295075658E+04*x*x+ 2*5.774044953825824E+03*x*y+ 3*1.833030149275268E+02*y*y+-1.429763371616711E+04*x*x*x+-2*2.062158902373028E+04*x*x*y+-3*3.666060369213731E+03*x*y*y+ 4*1.477433029163776E-06*y*y*y+ 6.048998614115979E+03*x*x*x*x+ 2*1.512249834952116E+04*x*x*x*y+ 3*1.008166605651047E+04*x*x*y*y;
        case 19: return  2.078460790604852E+02+-2.909844994480356E+03*x+-2*9.353073863098218E+02*y+ 7.482457909279853E+03*x*x+ 2*1.215899583458535E+04*x*y+ 3*1.454922624147049E+03*y*y+-7.066764912559228E+03*x*x*x+-2*2.151206857134464E+04*x*x*y+-3*1.745907139924879E+04*x*y*y+-4*7.274613189125139E+02*y*y*y+ 2.286305899408025E+03*x*x*x*x+ 2*1.028837996460899E+04*x*x*x*y+ 3*1.600414831467970E+04*x*x*y*y+ 4*8.002074513731438E+03*x*y*y*y;
        case 20: return  3.446737503461372E+02+-1.378694882483679E+03*x+-2*2.412716282265750E+03*y+ 2.068041931439891E+03*x*x+ 2*7.238148529865374E+03*x*y+ 3*6.433910121171304E+03*y*y+-1.378694134049671E+03*x*x*x+-2*7.238147869806153E+03*x*x*y+-3*1.286781990429334E+04*x*y*y+-4*7.238148907286980E+03*y*y*y+ 3.446733285357364E+02*x*x*x*x+ 2*2.412715565158995E+03*x*x*x*y+ 3*6.433909612999752E+03*x*x*y*y+ 4*7.238148781371233E+03*x*y*y*y+ 5*2.895259567891218E+03*y*y*y*y;
    }
}
